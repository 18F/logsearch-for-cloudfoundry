##---------------------------------------------------------------
# Parses app Error events.                                       |
# An Error event represents an error in the originating process. |
##---------------------------------------------------------------
if( [@type] == "Error" ) {

    mutate {
      add_tag => [ "error" ]

      # firehose-to-syslog names Error.source as "delta" for some reason.
      # Opened issue: https://github.com/cloudfoundry-community/firehose-to-syslog/issues/114
      #
      # Meanwhile rename to original to dropsonde protocol name "source".
      rename => { "[parsed_json_field][delta]" => "[parsed_json_field][source]" }

      rename => { "[parsed_json_field][message]" => "@message" }
    }
}
